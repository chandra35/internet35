================================================================================
                    VSOL V1600D OLT - SNMP OID REFERENCE
================================================================================

Tanggal: 2 Februari 2026
Device: VSOL V1600D EPON OLT
Enterprise ID: 37950
IP Test: 172.16.16.3
SNMP Community: private (read/write)

================================================================================
                              REFERENSI WEB
================================================================================

1. OID Repository (oid-base.com)
   - Base: https://oid-base.com/get/1.3.6.1.4.1.37950
   - v1600d: https://oid-base.com/get/1.3.6.1.4.1.37950.1.1.5
   - v1600dOnuMgmt: https://oid-base.com/get/1.3.6.1.4.1.37950.1.1.5.12
   - onuAuth: https://oid-base.com/get/1.3.6.1.4.1.37950.1.1.5.12.1
   - onuListTable: https://oid-base.com/get/1.3.6.1.4.1.37950.1.1.5.12.1.9
   - onuListEntry: https://oid-base.com/get/1.3.6.1.4.1.37950.1.1.5.12.1.9.1

2. Tree Display
   - https://oid-base.com/cgi-bin/display?tree=1.3.6.1.4.1.37950.1.1.5.12.1

3. LibreNMS MIB File (OFFICIAL)
   - https://github.com/librenms/librenms/blob/master/mibs/vsolution/V1600D
   - Source: Raw MIB definition langsung dari LibreNMS
   - KONFIRMASI: onuListTable HANYA 5 kolom (tanpa description)

================================================================================
                           STRUKTUR OID VSOL
================================================================================

Enterprise OID: 1.3.6.1.4.1.37950
  └── business(1)
      └── devices(1)
          └── v1600d(5)
              ├── v1600dPonPortMgmt(11) - PON Port Management
              │   └── vsolEponPortTable(1)
              │       └── vsolEponPortEntry(1)
              │           ├── .1 = ponPortIndex
              │           ├── .2 = ponPortDesc
              │           └── .3 = ponPortStatus
              │
              └── v1600dOnuMgmt(12) - ONU Management
                  └── onuAuth(1)
                      ├── authModeTable(1)
                      ├── whiteMaclistCfg(2)
                      ├── onuListTable(9) ★ PRIMARY TABLE
                      ├── onuTypeCfg(10)
                      ├── onuAuthInfoTable(21)
                      ├── onuMacAddrLimit(30)
                      ├── onuAuthInfo3Table(31)
                      ├── onlineOnuAuthInfo3Table(32)
                      └── manualConfirmOnu(33)

================================================================================
                    ONU LIST TABLE (PRIMARY) - VERIFIED WORKING!
================================================================================

Base OID: 1.3.6.1.4.1.37950.1.1.5.12.1.9.1

Columns (onuListEntry):
┌─────────┬──────────────┬─────────────────────────────────────────────────┐
│ Column  │ Name         │ Description                                     │
├─────────┼──────────────┼─────────────────────────────────────────────────┤
│ .1      │ onuIndex     │ Global sequential index (0, 1, 2, 3...)         │
│ .2      │ ponId        │ PON port number (1, 2, 3, 4)                    │
│ .3      │ llid         │ ONU ID within PON port (0, 1, 2...)             │
│ .4      │ status       │ Status string ("auth success", "auth fail")    │
│ .5      │ macAddress   │ MAC address format "xx:xx:xx:xx:xx:xx"          │
│ .6+     │ -            │ NOT AVAILABLE (no description via SNMP)        │
└─────────┴──────────────┴─────────────────────────────────────────────────┘

Full OIDs:
  onuIndex:     1.3.6.1.4.1.37950.1.1.5.12.1.9.1.1
  ponId:        1.3.6.1.4.1.37950.1.1.5.12.1.9.1.2
  llid:         1.3.6.1.4.1.37950.1.1.5.12.1.9.1.3
  status:       1.3.6.1.4.1.37950.1.1.5.12.1.9.1.4
  macAddress:   1.3.6.1.4.1.37950.1.1.5.12.1.9.1.5

Index Format: .{column}.{globalIndex}
Example: .1.3.6.1.4.1.37950.1.1.5.12.1.9.1.5.0 = MAC of first ONU

================================================================================
                         AUTH MODE TABLE
================================================================================

Base OID: 1.3.6.1.4.1.37950.1.1.5.12.1.1.1

Columns (authModeEntry):
┌─────────┬──────────────┬─────────────────────────────────────────────────┐
│ Column  │ Name         │ Description                                     │
├─────────┼──────────────┼─────────────────────────────────────────────────┤
│ .1      │ ponPortIndex │ PON port number (1, 2, 3, 4)                    │
│ .2      │ authMode     │ Authentication mode (0 = MAC auth)             │
└─────────┴──────────────┴─────────────────────────────────────────────────┘

================================================================================
                    ONU AUTH INFO TABLE ★ DESCRIPTION & DISTANCE!
================================================================================

Base OID: 1.3.6.1.4.1.37950.1.1.5.12.1.12.1

PENTING: Table ini berisi nama pelanggan/deskripsi yang diset via Web GUI OLT!

Columns (onuAuthInfoEntry):
┌─────────┬────────────────────────┬───────────────────────────────────────────┐
│ Column  │ Name                   │ Description                               │
├─────────┼────────────────────────┼───────────────────────────────────────────┤
│ .2      │ authInfoPonNo          │ PON port number (1, 2, 3, 4)              │
│ .3      │ authInfoOnuNo          │ ONU ID within PON port                    │
│ .10     │ onuAuthInfoDescription │ ★ NAMA PELANGGAN / DESCRIPTION!          │
│ .13     │ onuAuthInfoRtt         │ Round Trip Time (untuk hitung distance)   │
└─────────┴────────────────────────┴───────────────────────────────────────────┘

Full OIDs:
  authInfoPonNo:          1.3.6.1.4.1.37950.1.1.5.12.1.12.1.2
  authInfoOnuNo:          1.3.6.1.4.1.37950.1.1.5.12.1.12.1.3
  onuAuthInfoDescription: 1.3.6.1.4.1.37950.1.1.5.12.1.12.1.10  ★★★
  onuAuthInfoRtt:         1.3.6.1.4.1.37950.1.1.5.12.1.12.1.13

Index Format: .{column}.{authInfoIndex}  (authInfoIndex = 0, 1, 2, 3...)

Sample Data (Verified 2026-02-02):
  PON 1 / ONU 1 => "Rahmat" (dist: 90m)
  PON 1 / ONU 2 => "Agus-Gendon" (dist: 42m)
  PON 1 / ONU 3 => "Rt-Kenthi" (dist: 45m)
  Total: 239 entries with description

CATATAN RTT → Distance:
  - RTT dalam nanoseconds
  - Approximate: distance_meters = RTT / 10 (karena speed of light roundtrip)
  - Contoh: RTT 900 → ~90 meter

================================================================================
                    ONU OPTICAL POWER TABLE ★ RX/TX POWER!
================================================================================

Base OID: 1.3.6.1.4.1.37950.1.1.5.12.2.1.8.1

Columns:
┌─────────┬──────────────┬─────────────────────────────────────────────────┐
│ Column  │ Name         │ Description                                     │
├─────────┼──────────────┼─────────────────────────────────────────────────┤
│ .6      │ onuTxPower   │ ONU TX Power (format: "X.XX mW (Y.YY dBm)")     │
│ .7      │ onuRxPower   │ ONU RX Power (format: "X.XX mW (Y.YY dBm)")     │
└─────────┴──────────────┴─────────────────────────────────────────────────┘

Full OIDs:
  onuTxPower: 1.3.6.1.4.1.37950.1.1.5.12.2.1.8.1.6
  onuRxPower: 1.3.6.1.4.1.37950.1.1.5.12.2.1.8.1.7

Index Format: .{column}.{ponId}.{onuId}
Example: .1.3.6.1.4.1.37950.1.1.5.12.2.1.8.1.7.1.5 = RX Power PON1 ONU5

Sample Return Values:
  "0.01 mW (-20.92 dBm)"  → Parse dBm value: -20.92
  "0.00 mW (-27.50 dBm)"  → Parse dBm value: -27.50

Parsing (PHP):
  preg_match('/\(([+-]?[\d.]+)\s*dBm\)/i', $value, $matches);
  $dbm = (float) $matches[1];

================================================================================
                    ONU TRAFFIC STATISTICS TABLE
================================================================================

Base OID: 1.3.6.1.4.1.37950.1.1.5.12.1.20.1

Columns:
┌─────────┬──────────────┬─────────────────────────────────────────────────┐
│ Column  │ Name         │ Description                                     │
├─────────┼──────────────┼─────────────────────────────────────────────────┤
│ .3      │ rxOctets     │ Total bytes received by ONU (download)          │
│ .10     │ txOctets     │ Total bytes transmitted by ONU (upload)         │
└─────────┴──────────────┴─────────────────────────────────────────────────┘

Full OIDs:
  rxOctets: 1.3.6.1.4.1.37950.1.1.5.12.1.20.1.3
  txOctets: 1.3.6.1.4.1.37950.1.1.5.12.1.20.1.10

Index Format: .{column}.{ponId}.{onuId}
Example: .1.3.6.1.4.1.37950.1.1.5.12.1.20.1.3.2.1 = RX octets PON2 ONU1

Calculating Rate (Mbps):
  // Sample every 5 seconds
  $byteDiff = $currentBytes - $previousBytes;
  $rateMbps = ($byteDiff * 8) / (5 * 1000000);

================================================================================
                         PON PORT TABLE
================================================================================

Base OID: 1.3.6.1.4.1.37950.1.1.5.11.1.1.1

Columns (vsolEponPortEntry):
┌─────────┬──────────────┬─────────────────────────────────────────────────┐
│ Column  │ Name         │ Description                                     │
├─────────┼──────────────┼─────────────────────────────────────────────────┤
│ .1      │ ponPortIndex │ PON port index                                  │
│ .2      │ ponPortDesc  │ PON port description                            │
│ .3      │ ponPortStatus│ Port status                                     │
└─────────┴──────────────┴─────────────────────────────────────────────────┘

================================================================================
                    ONU AUTH INFO 3 TABLE
================================================================================

Base OID: 1.3.6.1.4.1.37950.1.1.5.12.1.31.1

Columns (onuAuthInfo3Entry):
┌─────────┬────────────────────┬───────────────────────────────────────────┐
│ Column  │ Name               │ Description                               │
├─────────┼────────────────────┼───────────────────────────────────────────┤
│ .1      │ authInfoPonNo3     │ PON port number                           │
│ .2      │ authInfoOnuNo3     │ ONU number                                │
│ .3      │ onuAuthInfo3Details│ Detail info (possibly description?)       │
└─────────┴────────────────────┴───────────────────────────────────────────┘

Index Format: .{column}.{ponId}.{onuId}

================================================================================
                         SAMPLE DATA (Verified)
================================================================================

Total ONUs found: 180
Distribution:
  - PON Port 1: 55 ONUs
  - PON Port 2: 40 ONUs
  - PON Port 3: 40 ONUs
  - PON Port 4: 45 ONUs

Sample SNMP Walk Results:
┌───────┬─────────┬──────┬──────────────┬───────────────────┐
│ Index │ ponId   │ llid │ status       │ macAddress        │
├───────┼─────────┼──────┼──────────────┼───────────────────┤
│ 0     │ 2       │ 0    │ auth success │ a8:2b:cd:aa:e5:53 │
│ 1     │ 2       │ 1    │ auth success │ 74:b5:7e:0c:63:1f │
│ 2     │ 2       │ 4    │ auth success │ 50:5d:7a:29:fb:6b │
│ ...   │ ...     │ ... │ ...          │ ...               │
└───────┴─────────┴──────┴──────────────┴───────────────────┘

================================================================================
                    CATATAN PENTING
================================================================================

1. DESCRIPTION TERSEDIA VIA onuAuthInfoTable! (UPDATED 2026-02-02)
   - Description/nama pelanggan ADA di OID: .12.1.12.1.10
   - BUKAN di onuListTable (.12.1.9) yang hanya 5 kolom
   - Perlu mapping via authInfoPonNo (.2) + authInfoOnuNo (.3)
   - Total 239 ONU dengan description berhasil diambil

2. onuListTable (1.3.6.1.4.1.37950.1.1.5.12.1.9)
   - Hanya 5 kolom: index, ponId, llid, status, macAddress
   - TIDAK mengandung description
   - Gunakan untuk list ONU dan MAC address

3. OPTICAL POWER FORMAT
   - VSOL mengembalikan format string: "0.01 mW (-20.92 dBm)"
   - Perlu parsing untuk extract nilai dBm
   - Index: .{ponId}.{onuId} (bukan global index)

4. TRAFFIC COUNTERS
   - rxOctets = download (OLT → ONU)
   - txOctets = upload (ONU → OLT)
   - Counter 64-bit, perlu handle wrap-around

5. ONU TYPE
   - OID .12.1.10.1.7 mengembalikan "unknow" untuk semua ONU
   - EPON tidak bisa detect vendor/model ONU (keterbatasan protokol)
   - Berbeda dengan GPON yang bisa identify ONU

6. INDEX MAPPING
   - onuListTable: index by globalIndex (0, 1, 2, 3...)
   - onuAuthInfoTable: index by authInfoIndex (0, 1, 2, 3...)
   - Optical Power: index by ponId.onuId (1.1, 1.2, 2.1, ...)
   - Traffic Stats: index by ponId.onuId (1.1, 1.2, 2.1, ...)

7. MAC ADDRESS FORMAT
   - SNMP mengembalikan format "xx:xx:xx:xx:xx:xx" (lowercase, colon-separated)
   - Siap digunakan tanpa konversi

================================================================================
                         PHP SNMP USAGE
================================================================================

// Contoh mengambil semua ONU
$oltIp = '172.16.16.3';
$community = 'private';

snmp_set_quick_print(true);
snmp_set_valueretrieval(SNMP_VALUE_PLAIN);

// Walk onuListTable (MAC, status)
$onuIndex = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.9.1.1');
$ponId = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.9.1.2');
$llid = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.9.1.3');
$status = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.9.1.4');
$macAddress = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.9.1.5');

// Walk onuAuthInfoTable (description, distance)
$authPonNo = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.12.1.2');
$authOnuNo = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.12.1.3');
$authDesc = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.12.1.10');
$authRtt = snmpwalkoid($oltIp, $community, '1.3.6.1.4.1.37950.1.1.5.12.1.12.1.13');

// Build description map
$descMap = [];
foreach ($authPonNo as $oid => $pon) {
    preg_match('/\.(\d+)$/', $oid, $m);
    $idx = $m[1];
    $onuId = $authOnuNo[str_replace('.2.', '.3.', $oid)] ?? null;
    $desc = $authDesc[str_replace('.2.', '.10.', $oid)] ?? '';
    $rtt = $authRtt[str_replace('.2.', '.13.', $oid)] ?? 0;
    $distance = $rtt > 0 ? round($rtt / 10, 0) : null;
    $descMap["$pon.$onuId"] = ['description' => $desc, 'distance' => $distance];
}

// Get optical power for specific ONU
$ponId = 1;
$onuId = 5;
$rxPower = snmpget($oltIp, $community, "1.3.6.1.4.1.37950.1.1.5.12.2.1.8.1.7.$ponId.$onuId");
$txPower = snmpget($oltIp, $community, "1.3.6.1.4.1.37950.1.1.5.12.2.1.8.1.6.$ponId.$onuId");
// Parse: "0.01 mW (-20.92 dBm)" -> -20.92
preg_match('/\(([+-]?[\d.]+)\s*dBm\)/i', $rxPower, $m);
$rxDbm = (float) $m[1];

// Get traffic for specific ONU
$rxOctets = snmpget($oltIp, $community, "1.3.6.1.4.1.37950.1.1.5.12.1.20.1.3.$ponId.$onuId");
$txOctets = snmpget($oltIp, $community, "1.3.6.1.4.1.37950.1.1.5.12.1.20.1.10.$ponId.$onuId");

================================================================================
                         FILE TERKAIT
================================================================================

- app/Helpers/Olt/VsolHelper.php - Main VSOL OLT helper class
- test_onu_list_table.php - Test script untuk onuListTable
- sync_onus_to_db.php - Script sync ONU ke database
- discover_onu_oids.php - OID discovery script

================================================================================
                         LAST UPDATED
================================================================================

Date: 2026-02-02 (Updated with onuAuthInfoTable discovery)
Author: chandra35
Verified on: VSOL V1600D at 172.16.16.3

Key Discoveries This Session:
- onuAuthInfoDescription OID (.12.1.12.1.10) contains customer names!
- 239 ONU descriptions successfully synced from OLT
- Distance calculated from RTT (.12.1.12.1.13)
- Optical Power format: "X.XX mW (Y.YY dBm)"
- Traffic counters at .12.1.20.1.3 (RX) and .12.1.20.1.10 (TX)

================================================================================
